#================================
#===
#=== GARDEN
#===
#================================
title: Garden
icon: mdi:flower
cards:

  #==========================
  #=== Master Control Switch
  #==========================
  - type: vertical-stack
    cards:

      - type: picture-entity
        entity: input_boolean.irrigation_master_control_switch
        image: /local/garden.jpg
        tap_action:
          action: toggle

      - type: conditional
        conditions:
          - entity: input_boolean.irrigation_master_control_switch
            state: 'on'
        card:
          type: vertical-stack
          cards:

            #=== Manual control buttons
            - type: horizontal-stack
              cards:
                - type: custom:toggle-lock-entity-row
#                - type: entity-button
                  entity: input_boolean.cycle1_manual_run
                  name: Morning Cycle
                  tap_action:
                    action: toggle

                - type: custom:toggle-lock-entity-row
#                - type: entity-button
                  entity: input_boolean.cycle2_manual_run
                  name: Afternoon Cycle
                  tap_action:
                    action: toggle

            #=== Manual control buttons
#            - type: horizontal-stack
#              cards:
#                - type: entity-button
#                  entity: input_boolean.cycle1_manual_run
#                  name: Morning Cycle
#                  tap_action:
#                    action: toggle
#                - type: entity-button
#                  entity: input_boolean.cycle2_manual_run
#                  name: Afternoon Cycle
#                  tap_action:
#                    action: toggle

            #=== Valve information
            - type: glance
              entities:
                - entity: switch.zone1_valve
                  icon: mdi:engine
                - entity: switch.zone2_valve
                  icon: mdi:engine

            #=== Temperature and Rainfall
            - type: entities
              title: Temperature and Rainfall
              show_header_toggle: false
              entities:
                - input_number.temperature_baseline
                - input_number.rainfall_threshold
                - type: custom:fold-entity-row
                  head:
                    type: section
                    label: History
                  items:
                    - type: section
                      label: Temperature

                    - entity: sensor.temp_high_2days
                      icon: mdi:thermometer
                    - entity: sensor.temp_high_5days
                      icon: mdi:thermometer

                    - type: divider
                      style:
                        height: 15px

                    - entity: sensor.temp_minus0
                      icon: mdi:thermometer
                    - entity: sensor.temp_minus1
                      icon: mdi:thermometer
                    - entity: sensor.temp_minus2
                      icon: mdi:thermometer
                    - entity: sensor.temp_minus3
                      icon: mdi:thermometer
                    - entity: sensor.temp_minus4
                      icon: mdi:thermometer

                    - type: section
                      label: Rainfall

                    - entity: sensor.rain_3days_ratio
                      icon: mdi:weather-rainy

                    - type: divider
                      style:
                        height: 15px

                    - entity: sensor.rain_minus0
                      icon: mdi:weather-rainy
                    - entity: sensor.rain_minus1
                      icon: mdi:weather-rainy
                    - entity: sensor.rain_minus2
                      icon: mdi:weather-rainy
                    - entity: sensor.rain_minus3
                      icon: mdi:weather-rainy

            #=== Irrigation History
            - type: entities
              title: Irrigation History
              show_header_toggle: false
              entities:
                - type: custom:fold-entity-row
                  head:
                    entity: sensor.last_irrigated_time
                    icon: mdi:update
                  items:
                    - entity: sensor.zone1_time_today
                      icon: mdi:water
                    - entity: sensor.zone2_time_today
                      icon: mdi:water


  #==================
  #=== Morning Cycle
  #==================
  - type: conditional
    conditions:
      - entity: input_boolean.irrigation_master_control_switch
        state: 'on'
    card:
      #=== Morning Cycle details
      type: entities
      title: Morning Cycle
      show_header_toggle: false
      entities:
        - sensor.cycle1_running
        - entity: sensor.cycle1_zone_being_watered
          icon: mdi:fountain
        - timer.cycle1_zone_duration
        - input_number.cycle1_zone1_duration
        - input_number.cycle1_zone2_duration

        #=== Morning Schedule details
        - type: custom:fold-entity-row
          head:
            entity: input_boolean.cycle1_enable
          items:
            - entity: sensor.cycle1_next_run_time
              icon: mdi:clock-start
            - input_select.cycle1_schedule_time
            - input_select.cycle1_watering_days

        #=== Morning Weather Adjustment details
        - type: custom:fold-entity-row
          head:
            entity: input_boolean.cycle1_use_weather_adjustment
          items:
            - entity: sensor.cycle1_zone1_duration_adjusted
              icon: mdi:camera-timer
            - entity: sensor.cycle1_zone2_duration_adjusted
              icon: mdi:camera-timer


  #====================
  #=== Afternoon Cycle
  #====================
  - type: conditional
    conditions:
      - entity: input_boolean.irrigation_master_control_switch
        state: 'on'
    card:
      #=== Afternoon Cycle details
      type: entities
      title: Afternoon Cycle
      show_header_toggle: false
      entities:
        - sensor.cycle2_running
        - entity: sensor.cycle2_zone_being_watered
          icon: mdi:fountain
        - timer.cycle2_zone_duration
        - input_number.cycle2_zone1_duration
        - input_number.cycle2_zone2_duration


        #=== Afternoon Schedule details
        - type: custom:fold-entity-row
          head:
            entity: input_boolean.cycle2_enable
          items:
            - entity: sensor.cycle2_next_run_time
              icon: mdi:clock-start
            - input_select.cycle2_schedule_time
            - input_select.cycle2_watering_days

        #=== Afternoon Weather Adjustment details
        - type: custom:fold-entity-row
          head:
            entity: input_boolean.cycle2_use_weather_adjustment
          items:
            - entity: sensor.cycle2_zone1_duration_adjusted
              icon: mdi:camera-timer
            - entity: sensor.cycle2_zone2_duration_adjusted
              icon: mdi:camera-timer
